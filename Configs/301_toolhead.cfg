##--------------------------------------------------------------------

[extruder]
step_pin: EBBCan: PD0
dir_pin: !EBBCan: PD1           #CHECK DAS ! bei Rückwärtslauf
enable_pin: !EBBCan: PD2
heater_pin: EBBCan: PB13
#pwm_cycle_time: 0.02
#smooth_time: 0.4
#max_power: 0.8

  ##  Update value below when you perform extruder calibration
  ##  If you ask for 100mm of filament, but in reality it is 98mm:
  ##  rotation_distance = <previous_rotation_distance> * <actual_extrude_distance> / 100
  ##  22.6789511 is a good starting point
rotation_distance: 23.0432877 	#Bondtech 5mm Drive Gears

  ##  Update Gear Ratio depending on your Extruder Type
  ##  Use 50:10 for Stealthburner/Clockwork 2
gear_ratio: 50:10 

microsteps: 16
full_steps_per_rotation: 200    	#200 for 1.8 degree, 400 for 0.9 degree
nozzle_diameter: 0.400
filament_diameter: 1.750

  ## Check what thermistor type you have. See https://www.klipper3d.org/Config_Reference.html
  #common-thermistors for common thermistor types.
  ## Use "Generic 3950" for NTC 100k 3950 thermistors
  
sensor_type: MAX31865
sensor_pin: EBBCan: PA4
spi_bus: spi1
rtd_nominal_r: 1000   #EBB doc:100
rtd_reference_r: 4300 #EBB doc:43
rtd_num_of_wires: 2
rtd_use_50Hz_filter: True

  ##  Try to keep pressure_advance below 1.0
  
pressure_advance: 0.040                           # Default is 0.040
pressure_advance_smooth_time: 0.030               # Default is 0.040
smooth_time: 0.5
max_extrude_cross_section: 60.000                 # set high to avoid purge failure ## std: 5.000
max_extrude_only_distance: 1400                   # set extruder distance high
max_extrude_only_velocity: 75.0
max_extrude_only_accel: 1500
instantaneous_corner_velocity: 1.5
min_temp: 0
max_temp: 310
max_power: 0.95
min_extrude_temp: 180


##--------------------------------------------------------------------

[beacon]
serial: /dev/serial/by-id/usb-Beacon_Beacon_RevH_E669FF375154364134202020FF140D1A-if00
x_offset: 0   # update with offset from nozzle on your machine
y_offset: 17  # update with offset from nozzle on your machine
mesh_main_direction: x
mesh_runs: 2

    # The homing hooks replace homing_override and work with safe_z_home
home_gcode_pre_x: _HOME_PRE_AXIS AXIS=X
home_gcode_post_x: _HOME_POST_AXIS AXIS=X
home_gcode_pre_y: _HOME_PRE_AXIS AXIS=Y
home_gcode_post_y: _HOME_POST_AXIS AXIS=Y

home_xy_position: 148, 148 # update with your bed center
home_z_hop: 3
home_z_hop_speed: 30
home_xy_move_speed: 150
home_method: contact # use proximity for induction homing
home_method_when_homed: proximity # after initial calibration use induction
home_autocalibrate: unhomed # contact will calibrate beacon on first home

accel_axes_map: -x, -y, z            # acceleration sensor mapping


#[safe_z_home]                # Beacon now uses safe_z_home via CONTACT function
#home_xy_position: 150, 150
#home_xy_position: 150, 150  #   Sets the x, y position used for z homing with beacon
#z_hop: 3                    #   Retracts the z axis before x, y homing to avoid dragging the nozzle.

[resonance_tester]
probe_points: 148, 148, 25
accel_chip: beacon


#[temperature_sensor Toolhead]
#sensor_type: Generic 3950
#sensor_pin: EBBCan: PA2

#[adxl345]
#cs_pin: EBBCan: PB12
#spi_software_sclk_pin: EBBCan: PB10
#spi_software_mosi_pin: EBBCan: PB11
#spi_software_miso_pin: EBBCan: PB2
#axes_map: z,-y,x


##--------------------------------------------------------------------

[tmc2209 extruder]
uart_pin: EBBCan: PA15
interpolate: True
run_current: 0.30 #min current, equivalent to 0.42A peak (Peak = RMS/0.707)
#run_current: 0.35 #max current, equivalent to 0.49A peak (Peak = RMS/0.707)
stealthchop_threshold: 999999


##--------------------------------------------------------------------


